---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import { formatDate } from '@/utils/date';

export interface Props {
  post: CollectionEntry<'blog'>;
  variant?: 'default' | 'compact';
}

const { post, variant = 'default' } = Astro.props;
const { title, description, heroImage, publishedAt, tags, category } = post.data;
---

<article
  class={`group relative overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm transition-all hover:shadow-lg ${
    variant === 'compact' ? 'p-4' : 'p-6'
  }`}
>
  {
    heroImage && (
      <div
        class={`relative overflow-hidden ${
          variant === 'compact' ? 'mb-4 h-32' : 'mb-6 h-48'
        }`}
      >
        <Image
          src={heroImage}
          alt={title}
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
          width={variant === 'compact' ? 400 : 600}
          height={variant === 'compact' ? 200 : 300}
        />
      </div>
    )
  }

  <div class="space-y-3">
    <div class="flex items-center gap-2 text-sm text-muted-foreground">
      <time datetime={publishedAt.toISOString()}>
        {formatDate(publishedAt)}
      </time>
      <span>â€¢</span>
      <span>{category}</span>
    </div>

    <h3
      class={`font-bold leading-tight ${
        variant === 'compact' ? 'text-lg' : 'text-xl'
      }`}
    >
      <a
        href={`/blog/${post.slug}`}
        class="transition-colors hover:text-primary"
      >
        {title}
      </a>
    </h3>

    <p
      class={`text-muted-foreground ${
        variant === 'compact' ? 'text-sm line-clamp-2' : 'line-clamp-3'
      }`}
    >
      {description}
    </p>

    {tags && tags.length > 0 && (
        <div class="flex flex-wrap gap-2">
          {tags.slice(0, variant === 'compact' ? 2 : 3).map((tag: string) => (
            <span class="inline-flex items-center rounded-full bg-secondary px-2.5 py-0.5 text-xs font-semibold text-secondary-foreground">
              {tag}
            </span>
          ))}
        </div>
      )}
  </div>
</article>
