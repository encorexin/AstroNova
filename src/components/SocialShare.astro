---
export interface Props {
  url: string;
  title: string;
  description: string;
  tags?: string[];
}

const { url, title, tags = [] } = Astro.props;

const encodedUrl = encodeURIComponent(url);
const encodedTitle = encodeURIComponent(title);

const encodedTags = tags.map((tag: string) => encodeURIComponent(tag)).join(',');

const _shareLinks = [
  {
    name: 'Twitter',
    url: `https://twitter.com/intent/tweet?url=${encodedUrl}&text=${encodedTitle}&hashtags=${encodedTags}`,
    icon: 'M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z',
    color: 'bg-[#1DA1F2] hover:bg-[#1DA1F2]/90',
  },
  {
    name: 'Facebook',
    url: `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`,
    icon: 'M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z',
    color: 'bg-[#1877F2] hover:bg-[#1877F2]/90',
  },
  {
    name: 'LinkedIn',
    url: `https://www.linkedin.com/sharing/share-offsite/?url=${encodedUrl}`,
    icon: 'M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z M2 9h4v12H2z M4 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4z',
    color: 'bg-[#0A66C2] hover:bg-[#0A66C2]/90',
  },
  {
    name: 'Reddit',
    url: `https://reddit.com/submit?url=${encodedUrl}&title=${encodedTitle}`,
    icon: 'M12 2a10 10 0 0 0-10 10 10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2zm0 18a8 8 0 0 1-8-8 8 8 0 0 1 8-8 8 8 0 0 1 8 8 8 8 0 0 1-8 8zm-1-13h2v6.5l3.5-3.5 1.42 1.42L12 19.84l-5.92-5.92L7.5 12.5l3.5 3.5z',
    color: 'bg-[#FF4500] hover:bg-[#FF4500]/90',
  },
  {
    name: 'WhatsApp',
    url: `https://wa.me/?text=${encodedTitle} ${encodedUrl}`,
    icon: 'M12 2a10 10 0 0 0-10 10 10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2zm4.39 6.7c-.29.13-1.7.84-1.96.94s-.45.14-.64-.14c-.19-.29-.74-1.02-.9-1.23-.16-.21-.32-.22-.61-.07s-.78.29-1.48.92c-.54.48-.9 1.07-.99 1.26s-.01.47.14.61.29.35.48.54.22.29.37.48.16.35.22.54.01.42-.12.61c-.13.19-.58 1.02-.79 1.4s-.42.79-.42 1.02c0 .23.01.35.01.42s.13.16.29.16h.67c.29 0 .64-.1.96-.29.32-.19.48-.35.61-.54.13-.19.29-.35.48-.54.19-.19.35-.35.54-.48.19-.13.32-.29.42-.48s.19-.42.19-.67c0-.25-.06-.44-.19-.61s-.29-.35-.54-.54c-.25-.19-.54-.35-.83-.48-.29-.13-.54-.22-.74-.29s-.35-.19-.35-.42c0-.23.06-.35.19-.48s.29-.19.48-.19h.42c.29 0 .58.06.83.19.25.13.48.29.67.48.19.19.35.35.48.54.13.19.29.35.48.54.19.19.35.35.54.48.19.13.32.29.42.48s.19.42.19.67c0 .25-.06.44-.19.61s-.29.35-.54.54c-.25.19-.54.35-.83.48-.29.13-.54.22-.74.29s-.35.19-.35.42c0 .23.06.35.19.48s.29.19.48.19h.42z',
    color: 'bg-[#25D366] hover:bg-[#25D366]/90',
  },
];
---

<div class="mt-8 border-t pt-8">
  <h3 class="mb-4 text-lg font-semibold">Share this article</h3>
  <div class="flex flex-wrap gap-2">
    {
      _shareLinks.map((link) => (
        <a
          href={link.url}
          target="_blank"
          rel="noopener noreferrer"
          class={`inline-flex items-center gap-2 rounded-md px-3 py-2 text-sm font-medium text-white transition-colors ${link.color}`}
          aria-label={`Share on ${link.name}`}
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="currentColor"
            stroke="none"
          >
            <path d={link.icon} />
          </svg>
          <span>{link.name}</span>
        </a>
      ))
    }

    <button
      class="inline-flex items-center gap-2 rounded-md bg-muted px-3 py-2 text-sm font-medium text-foreground transition-colors hover:bg-muted/80"
      onclick="navigator.clipboard.writeText(window.location.href); alert('Link copied to clipboard!')"
      aria-label="Copy link"
    >
      <svg
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"
        ></path>
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"
        ></path>
      </svg>
      <span>Copy Link</span>
    </button>
  </div>
</div>
